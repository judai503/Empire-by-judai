let handler = m => m

handler.before = async function (m, { conn }) {
  if (!m.text) return true

  // Detectar prefijos de comando
  const prefix = /^[.!#/$]/
  if (!prefix.test(m.text)) return true

  let chat = global.db.data.chats[m.chat]
  let now = Date.now()

  // Anti-spam (1 vez cada 10 minutos por chat)
  if (chat?.lastEmpireCanal && now - chat.lastEmpireCanal < 10 * 60 * 1000) return true
  chat.lastEmpireCanal = now

  await conn.sendMessage(m.chat, {
    text: 'ðŸ“¢ *Sigue el canal oficial de la AsociaciÃ³n Empire*',
    contextInfo: {
      externalAdReply: {
        title: 'AsociaciÃ³n Empire InformaciÃ³n',
        body: 'Avisos â€¢ Comunicados â€¢ Actualizaciones',
        sourceUrl: 'https://whatsapp.com/channel/0029Vb6WpKMFXUuVwH7Hny3r',
        mediaType: 1,
        renderLargerThumbnail: true
      }
    }
  })

  return true
}

export default handler
